<!doctype html>
<html>
<head>
<title>Mon premier rendu 3D avec Three.js</title>
<meta charset="utf-8">
<link href="css/main.css" rel="stylesheet" />
</head>
<body>
	<div id="container"></div>
	<canvas id="myCanvas" width="1200" height="800"
		style="border: 1px solid #000000;">
  Your browser does not support the HTML5 canvas tag.</canvas>
	<script src="js/renderers/CanvasRenderer.js"></script>
	<script type="text/javascript">
		"use strict";
		//constantes
		const
		SIZE_SQUARE = 25;
		const
		NB_COL = 10;
		const
		NB_ROW = 15;
		const
		STAGE_INIT_VALUE = 0;
		const
		MAX_ROOM_TYPE = 99;
		//////////////////////////////DÉCLARATION DES OBJETS////////////////////////////
		function windowCanvas() {
			//attributs
			var canvas = document.getElementById("myCanvas");
			var ctx = canvas.getContext("2d");
			var floors = new Array();
			var roomTypes = new Map();
			var selectedFloor = 0;

			//méthodes
			this.WhereCursorIs = function() {
				return 0;
			};
			this.GetCanvas = function() {
				return canvas;
			};
			this.GetCtx = function() {
				return ctx;
			};
			this.GetFloors = function() {
				return floors;
			};
			this.GetRoomTypes = function() {
				return roomTypes;
			};
			this.GetSelectedFloor = function() {
				return selectedFloor;
			};
			this.NewFloor = function() {
				var stage = new Array();
				floors.push(stage); //nouveau étage
				for ( var x = 0; x < NB_COL; x++)
					stage.push(new Array());
				for ( var i = 0; i < NB_COL; i++) {
					for ( var j = 0; j < NB_ROW; j++) {
						stage[i].push(STAGE_INIT_VALUE);
					}
				}
				if (floors.lenght == 0)
					console.log("Étage créé !");
			}
			this.DrawFloor = function(selectedFloor) {
				var tempFloor = floors[selectedFloor];
				for ( var i = 0; i < NB_COL; i++) {
					for ( var j = 0; j < NB_ROW; j++) {

						ctx.fillStyle = roomTypes.get(tempFloor[i][j]);
						ctx.fillRect(i * SIZE_SQUARE, j * SIZE_SQUARE,
								SIZE_SQUARE, SIZE_SQUARE);
					}
				}
				for ( var i = 0; i < NB_ROW + 1; i++) {//affichage des ligne horizontales
					ctx.beginPath();
					ctx.moveTo(0, i * SIZE_SQUARE);
					ctx.lineTo(SIZE_SQUARE * NB_COL, i * SIZE_SQUARE);
					ctx.stroke();
				}
				for ( var i = 0; i < NB_COL + 1; i++) {//affichage des ligne verticales
					ctx.beginPath();
					ctx.moveTo(i * SIZE_SQUARE, 0);
					ctx.lineTo(i * SIZE_SQUARE, SIZE_SQUARE * NB_ROW);
					ctx.stroke();
				}
				console.log("Étage déssiné !");
			}
			this.NewRoomType = function(nameType, color) {
				if (roomTypes.get(nameType)) {
					console.log("ce nameType a déjà été créée");
					return;
				}
				if (nameType == 0) {
					roomTypes.set(nameType, "#F0F0F0");
					console.log("roomType vide créée");
					return;
				}
				roomTypes.set(nameType, "#" + color);
				console.log("nouvelle roomType : " + '"' + nameType + '"'
						+ " de couleur " + color);
			}
		}
		///////////////////////////////PROGRAMME///////////////////////
		var mainWindow = new windowCanvas();
		mainWindow.NewFloor();
		mainWindow.NewRoomType(0, "");
		mainWindow.NewRoomType("salle de bain", "FF0000");
		mainWindow.DrawFloor(mainWindow.GetSelectedFloor());
		console.log("Fin du programme");
		/*
		//go la, mec https://www.w3schools.com/tags/canvas_lineto.asp
		//objet map attribut	: nbCol;nbRow;c;ctx
		//objet map methodes	: Draw();
		
		//CONSANTE
		const SIZE_SQUARE = 25;
		
		//Déclaration des variables et objets + initialisation
		var map = {};
		map.nbCol = map.nbRow = 25;
		
		map.c = document.getElementById("myCanvas");
		map.ctx = map.c.getContext("2d");
		
		map.matrix = [];
		
		map.InitMatrix = function(){
			for(var i = 0; i < map.nbCol; i++)
			{
				for(var j = 0; j < map.nbCol; j++)
				{
					map.matrix[i,j]=0;
				}
			}
		}
		
		map.Draw = function(){
			if((map.nbCol<=0)||(map.nbRow<=0))
			{
				alert("le nombre de collones ou de ligne est inssufissant");
				return;
			}
			for(var i = 0; i < map.nbRow + 1; i++)
			{//affichage des ligne horizontales
				map.ctx.beginPath();
				map.ctx.moveTo(0,i*SIZE_SQUARE);
				map.ctx.lineTo(625,i*SIZE_SQUARE);
				map.ctx.stroke();
			}
			for(var i = 0; i < map.nbCol + 1; i++)
			{//affichage des ligne verticales
				map.ctx.beginPath();
				map.ctx.moveTo(i*SIZE_SQUARE,0);
				map.ctx.lineTo(i*SIZE_SQUARE,625);
				map.ctx.stroke();						
			}
		}
		
		  //Initialisation du tracking de la souris
		function GetMousePos(canvas, evt)
		{
			var rect = canvas.getBoundingClientRect();
			return {
				x: evt.clientX - rect.left;
				y: evt.clientY - rect.top;
			}
		}
		
			map.c.addEventListener('onmousedown', function(evt){
				var mousePos = GetMousePos(map.c, evt);
				var message = 'Mouse position: ' + mousePos.x + ',' + mousePos.y;
				writeMessage(map.c, message);
			}, false);
		}
		
		map.InitMatrix();
		map.Draw();
		mouse_position();
		 */
	</script>
</body>
</html>